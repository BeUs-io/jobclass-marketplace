import{b as R,c as A,f as U,r as X}from"./chunk-4L7TKHLH.js";import{$ as L,Da as o,Ea as F,F as S,Jb as k,Ka as h,Pa as f,R as H,Sa as m,Ua as C,Xa as i,Xb as O,Ya as r,Yb as P,Za as g,ab as T,bb as M,cb as c,cc as $,fc as z,ha as b,ia as _,ja as u,jb as l,ka as x,kb as I,lb as v,mb as W,n as w,pb as E,qb as j,rb as V,tb as Y,wb as B,y as N,yb as G}from"./chunk-WKEOFE6Q.js";var K=(()=>{class s{constructor(){this.conversations=h([{id:"conv1",participants:[{id:"user1",name:"You",role:"candidate",online:!0},{id:"emp1",name:"TechCorp HR",role:"employer",online:!0,avatar:"TC"}],lastMessage:{id:"msg3",conversationId:"conv1",senderId:"emp1",senderName:"TechCorp HR",content:"We would like to schedule an interview with you",timestamp:new Date("2024-03-20T10:30:00"),read:!1,type:"interview-invite"},unreadCount:2,jobTitle:"Senior Frontend Developer",company:"TechCorp"},{id:"conv2",participants:[{id:"user1",name:"You",role:"candidate",online:!0},{id:"emp2",name:"StartupXYZ",role:"employer",online:!1,avatar:"SX"}],lastMessage:{id:"msg6",conversationId:"conv2",senderId:"user1",senderName:"You",content:"Thank you for the opportunity!",timestamp:new Date("2024-03-19T15:45:00"),read:!0,type:"text"},unreadCount:0,jobTitle:"Full Stack Developer",company:"StartupXYZ"}]),this.messages=h([{id:"msg1",conversationId:"conv1",senderId:"user1",senderName:"You",content:"Hi, I applied for the Senior Frontend Developer position.",timestamp:new Date("2024-03-20T09:00:00"),read:!0,type:"text"},{id:"msg2",conversationId:"conv1",senderId:"emp1",senderName:"TechCorp HR",content:"Hello! Thank you for your application. We reviewed your profile and are impressed.",timestamp:new Date("2024-03-20T10:00:00"),read:!0,type:"text"},{id:"msg3",conversationId:"conv1",senderId:"emp1",senderName:"TechCorp HR",content:"We would like to schedule an interview with you",timestamp:new Date("2024-03-20T10:30:00"),read:!1,type:"interview-invite"},{id:"msg4",conversationId:"conv2",senderId:"emp2",senderName:"StartupXYZ",content:"Congratulations! We would like to offer you the position.",timestamp:new Date("2024-03-19T14:00:00"),read:!0,type:"offer"},{id:"msg5",conversationId:"conv2",senderId:"user1",senderName:"You",content:"This is fantastic news! I am very interested.",timestamp:new Date("2024-03-19T15:30:00"),read:!0,type:"text"},{id:"msg6",conversationId:"conv2",senderId:"user1",senderName:"You",content:"Thank you for the opportunity!",timestamp:new Date("2024-03-19T15:45:00"),read:!0,type:"text"}]),this.unreadCount=k(()=>this.conversations().reduce((e,t)=>e+t.unreadCount,0)),N(3e4).subscribe(()=>{this.simulateNewMessage()})}simulateNewMessage(){let e=["Are you available for a quick call?","We have reviewed your application","Could you provide more details about your experience?","Thank you for your interest in our company"],t=this.conversations();if(t.length>0){let n=t[0],a={id:`msg${Date.now()}`,conversationId:n.id,senderId:"emp1",senderName:"TechCorp HR",content:e[Math.floor(Math.random()*e.length)],timestamp:new Date,read:!1,type:"text"};this.messages.update(d=>[...d,a]),n.lastMessage=a,n.unreadCount++,this.conversations.set([...t])}}getConversations(){return w(this.conversations())}getMessages(e){return w(this.messages().filter(t=>t.conversationId===e))}sendMessage(e,t){let n={id:`msg${Date.now()}`,conversationId:e,senderId:"user1",senderName:"You",content:t,timestamp:new Date,read:!0,type:"text"};this.messages.update(y=>[...y,n]);let a=this.conversations(),d=a.findIndex(y=>y.id===e);return d!==-1&&(a[d].lastMessage=n,this.conversations.set([...a])),w(n).pipe(S(300))}markAsRead(e){let t=this.messages(),n=this.conversations();t.forEach(d=>{d.conversationId===e&&!d.read&&d.senderId!=="user1"&&(d.read=!0)});let a=n.findIndex(d=>d.id===e);return a!==-1&&(n[a].unreadCount=0),this.messages.set([...t]),this.conversations.set([...n]),w(!0).pipe(S(200))}deleteConversation(e){return this.conversations.update(t=>t.filter(n=>n.id!==e)),this.messages.update(t=>t.filter(n=>n.conversationId!==e)),w(!0).pipe(S(300))}static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275prov=H({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();function q(s,p){if(s&1&&(i(0,"span",31),l(1),r()),s&2){let e=c().$implicit;o(),v(" ",e.unreadCount," ")}}function Q(s,p){s&1&&(i(0,"span",32),l(1,"You: "),r())}function ee(s,p){if(s&1){let e=T();i(0,"div",17),M("click",function(){let n=b(e).$implicit,a=c();return _(a.selectConversation(n))}),i(1,"div",18)(2,"div",19)(3,"div",20)(4,"span",21),l(5),r()()(),i(6,"div",22)(7,"div",23)(8,"div",24)(9,"p",25),l(10),r(),i(11,"p",26),l(12),r()(),i(13,"div",27)(14,"p",26),l(15),r(),f(16,q,2,1,"span",28),r()(),i(17,"p",29),f(18,Q,2,0,"span",30),l(19),r()()()()}if(s&2){let e,t=p.$implicit,n=c();C("bg-blue-50",((e=n.selectedConversation())==null?null:e.id)===t.id),o(5),v(" ",n.getEmployerInitials(t)," "),o(5),v(" ",n.getEmployerName(t)," "),o(2),I(t.jobTitle),o(3),v(" ",n.formatMessageTime(t.lastMessage.timestamp)," "),o(),m("ngIf",t.unreadCount>0),o(2),m("ngIf",t.lastMessage.senderId==="user1"),o(),v(" ",t.lastMessage.content," ")}}function te(s,p){if(s&1){let e=T();i(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",36)(4,"span",37),l(5),r()(),i(6,"div",38)(7,"p",39),l(8),r(),i(9,"p",26),l(10),r()()(),i(11,"div",40)(12,"button",41),u(),i(13,"svg",42),g(14,"path",43),r()(),x(),i(15,"button",44),M("click",function(){b(e);let n=c();return _(n.deleteConversation())}),u(),i(16,"svg",42),g(17,"path",45),r()()()()()}if(s&2){let e=c();o(5),v(" ",e.getEmployerInitials(e.selectedConversation())," "),o(3),v(" ",e.getEmployerName(e.selectedConversation())," "),o(2),W(" ",e.selectedConversation().jobTitle," \u2022 ",e.selectedConversation().company," ")}}function ne(s,p){if(s&1&&(i(0,"div",54)(1,"div",55),u(),i(2,"svg",56),g(3,"path",57),r(),x(),i(4,"span",58),l(5,"Interview Invitation"),r()(),i(6,"p",59),l(7),r(),i(8,"button",60),l(9," Schedule Interview "),r()()),s&2){let e=c().$implicit;o(7),I(e.content)}}function ie(s,p){if(s&1&&(i(0,"div",61)(1,"div",55),u(),i(2,"svg",62),g(3,"path",63),r(),x(),i(4,"span",64),l(5,"Job Offer"),r()(),i(6,"p",65),l(7),r(),i(8,"div",66)(9,"button",67),l(10," View Offer "),r(),i(11,"button",68),l(12," Discuss "),r()()()),s&2){let e=c().$implicit;o(7),I(e.content)}}function se(s,p){if(s&1&&(i(0,"div",69)(1,"p",70),l(2),r()()),s&2){let e=c().$implicit;C("bg-blue-600",e.senderId==="user1")("text-white",e.senderId==="user1")("bg-white",e.senderId!=="user1")("text-gray-900",e.senderId!=="user1"),o(2),I(e.content)}}function re(s,p){s&1&&(i(0,"span",71),l(1,"\u2713\u2713"),r())}function oe(s,p){if(s&1&&(i(0,"div")(1,"div"),f(2,ne,10,1,"div",49)(3,ie,13,1,"div",50)(4,se,3,9,"div",51),i(5,"p",52),l(6),B(7,"date"),f(8,re,2,0,"span",53),r()()()),s&2){let e=p.$implicit;C("flex",!0)("justify-end",e.senderId==="user1"),o(),C("max-w-xs",!0)("lg:max-w-md",!0),o(),m("ngIf",e.type==="interview-invite"),o(),m("ngIf",e.type==="offer"),o(),m("ngIf",e.type==="text"),o(),C("text-right",e.senderId==="user1")("text-gray-500",!0),o(),v(" ",G(7,17,e.timestamp,"short")," "),o(2),m("ngIf",e.senderId==="user1"&&e.read)}}function ae(s,p){if(s&1&&(i(0,"div",46)(1,"div",47),f(2,oe,9,20,"div",48),r()()),s&2){let e=c();o(2),m("ngForOf",e.messages())}}function le(s,p){if(s&1){let e=T();i(0,"div",72)(1,"div",73)(2,"button",41),u(),i(3,"svg",74),g(4,"path",75),r()(),x(),i(5,"div",76)(6,"textarea",77),V("ngModelChange",function(n){b(e);let a=c();return j(a.newMessage,n)||(a.newMessage=n),_(n)}),M("keydown.enter",function(n){b(e);let a=c();return _(a.handleEnterKey(n))}),l(7,"                  "),r()(),i(8,"button",78),M("click",function(){b(e);let n=c();return _(n.sendMessage())}),u(),i(9,"svg",42),g(10,"path",79),r()()()()}if(s&2){let e=c();o(6),E("ngModel",e.newMessage),o(2),m("disabled",!e.newMessage.trim())}}function de(s,p){s&1&&(i(0,"div",80)(1,"div",81),u(),i(2,"svg",82),g(3,"path",83),r(),x(),i(4,"h3",84),l(5,"No conversation selected"),r(),i(6,"p",85),l(7,"Choose a conversation from the list to start messaging."),r()()())}var we=(()=>{class s{constructor(e){this.messagingService=e,this.conversations=h([]),this.selectedConversation=h(null),this.messages=h([]),this.searchTerm="",this.newMessage="",this.filteredConversations=k(()=>{let t=this.searchTerm.toLowerCase();return t?this.conversations().filter(n=>n.participants.find(d=>d.role==="employer")?.name.toLowerCase().includes(t)||n.jobTitle?.toLowerCase().includes(t)||n.company?.toLowerCase().includes(t)):this.conversations()})}ngOnInit(){this.loadConversations()}loadConversations(){this.messagingService.getConversations().subscribe(e=>{this.conversations.set(e),e.length>0&&!this.selectedConversation()&&this.selectConversation(e[0])})}selectConversation(e){this.selectedConversation.set(e),this.loadMessages(e.id),this.messagingService.markAsRead(e.id).subscribe(()=>{this.loadConversations()})}loadMessages(e){this.messagingService.getMessages(e).subscribe(t=>{this.messages.set(t)})}sendMessage(){!this.newMessage.trim()||!this.selectedConversation()||this.messagingService.sendMessage(this.selectedConversation().id,this.newMessage).subscribe(()=>{this.newMessage="",this.loadMessages(this.selectedConversation().id),this.loadConversations()})}deleteConversation(){this.selectedConversation()&&confirm("Are you sure you want to delete this conversation?")&&this.messagingService.deleteConversation(this.selectedConversation().id).subscribe(()=>{this.selectedConversation.set(null),this.messages.set([]),this.loadConversations()})}getEmployerName(e){return e.participants.find(n=>n.role==="employer")?.name||"Unknown"}getEmployerInitials(e){let t=e.participants.find(a=>a.role==="employer");return t?.avatar?t.avatar:(t?.name||"Unknown").split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2)}formatMessageTime(e){let t=new Date,n=new Date(e),a=t.getTime()-n.getTime(),d=Math.floor(a/(1e3*60*60)),y=Math.floor(a/(1e3*60*60*24));if(d<1){let D=Math.floor(a/6e4);return D===0?"Just now":`${D}m ago`}else return d<24?`${d}h ago`:y<7?`${y}d ago`:n.toLocaleDateString("en-US",{month:"short",day:"numeric"})}handleEnterKey(e){e.shiftKey||(e.preventDefault(),this.sendMessage())}static{this.\u0275fac=function(t){return new(t||s)(F(K))}}static{this.\u0275cmp=L({type:s,selectors:[["app-messages"]],standalone:!0,features:[Y],decls:18,vars:6,consts:[[1,"min-h-screen","bg-gray-50"],[1,"max-w-7xl","mx-auto"],[1,"flex","h-screen"],[1,"w-1/3","bg-white","border-r","border-gray-200"],[1,"p-4","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900"],[1,"mt-3","relative"],["type","text","placeholder","Search conversations...",1,"w-full","px-4","py-2","pl-10","pr-4","text-sm","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"absolute","left-3","top-2.5","h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"overflow-y-auto",2,"height","calc(100vh - 140px)"],["class","p-4 border-b border-gray-200 hover:bg-gray-50 cursor-pointer",3,"bg-blue-50","click",4,"ngFor","ngForOf"],[1,"flex-1","flex","flex-col"],["class","bg-white px-6 py-4 border-b border-gray-200",4,"ngIf"],["class","flex-1 overflow-y-auto p-6 bg-gray-50",4,"ngIf"],["class","bg-white px-6 py-4 border-t border-gray-200",4,"ngIf"],["class","flex-1 flex items-center justify-center bg-gray-50",4,"ngIf"],[1,"p-4","border-b","border-gray-200","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"flex","items-start"],[1,"flex-shrink-0"],[1,"w-12","h-12","bg-blue-100","rounded-full","flex","items-center","justify-center"],[1,"text-blue-600","font-semibold"],[1,"ml-3","flex-1","min-w-0"],[1,"flex","justify-between","items-start"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-gray-900","truncate"],[1,"text-xs","text-gray-500"],[1,"flex","flex-col","items-end"],["class","mt-1 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-blue-600 rounded-full",4,"ngIf"],[1,"mt-1","text-sm","text-gray-600","truncate"],["class","text-gray-500",4,"ngIf"],[1,"mt-1","inline-flex","items-center","justify-center","px-2","py-1","text-xs","font-bold","leading-none","text-white","bg-blue-600","rounded-full"],[1,"text-gray-500"],[1,"bg-white","px-6","py-4","border-b","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"flex","items-center"],[1,"w-10","h-10","bg-blue-100","rounded-full","flex","items-center","justify-center"],[1,"text-blue-600","font-semibold","text-sm"],[1,"ml-3"],[1,"text-sm","font-medium","text-gray-900"],[1,"flex","items-center","space-x-2"],[1,"p-2","text-gray-400","hover:text-gray-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"p-2","text-gray-400","hover:text-gray-600",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex-1","overflow-y-auto","p-6","bg-gray-50"],[1,"space-y-4"],[3,"flex","justify-end",4,"ngFor","ngForOf"],["class","bg-purple-100 rounded-lg p-4 border border-purple-200",4,"ngIf"],["class","bg-green-100 rounded-lg p-4 border border-green-200",4,"ngIf"],["class","rounded-lg px-4 py-2 shadow",3,"bg-blue-600","text-white","bg-white","text-gray-900",4,"ngIf"],[1,"text-xs","mt-1"],["class","ml-1",4,"ngIf"],[1,"bg-purple-100","rounded-lg","p-4","border","border-purple-200"],[1,"flex","items-center","mb-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-purple-600","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-sm","font-semibold","text-purple-800"],[1,"text-sm","text-purple-900"],[1,"mt-3","w-full","px-4","py-2","bg-purple-600","text-white","text-sm","font-medium","rounded","hover:bg-purple-700"],[1,"bg-green-100","rounded-lg","p-4","border","border-green-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-600","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","font-semibold","text-green-800"],[1,"text-sm","text-green-900"],[1,"mt-3","flex","space-x-2"],[1,"flex-1","px-4","py-2","bg-green-600","text-white","text-sm","font-medium","rounded","hover:bg-green-700"],[1,"flex-1","px-4","py-2","bg-white","text-green-600","border","border-green-600","text-sm","font-medium","rounded","hover:bg-green-50"],[1,"rounded-lg","px-4","py-2","shadow"],[1,"text-sm"],[1,"ml-1"],[1,"bg-white","px-6","py-4","border-t","border-gray-200"],[1,"flex","items-end","space-x-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"],[1,"flex-1"],["placeholder","Type a message...","rows","1",1,"w-full","px-4","py-2","text-sm","border","border-gray-300","rounded-lg","resize-none","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","keydown.enter","ngModel"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 19l9 2-9-18-9 18 9-2zm0 0v-8"],[1,"flex-1","flex","items-center","justify-center","bg-gray-50"],[1,"text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"]],template:function(t,n){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),l(6,"Messages"),r(),i(7,"div",6)(8,"input",7),V("ngModelChange",function(d){return j(n.searchTerm,d)||(n.searchTerm=d),d}),r(),u(),i(9,"svg",8),g(10,"path",9),r()()(),x(),i(11,"div",10),f(12,ee,20,9,"div",11),r()(),i(13,"div",12),f(14,te,18,4,"div",13)(15,ae,3,1,"div",14)(16,le,11,2,"div",15)(17,de,8,0,"div",16),r()()()()),t&2&&(o(8),E("ngModel",n.searchTerm),o(4),m("ngForOf",n.filteredConversations()),o(2),m("ngIf",n.selectedConversation()),o(),m("ngIf",n.selectedConversation()),o(),m("ngIf",n.selectedConversation()),o(),m("ngIf",!n.selectedConversation()))},dependencies:[z,O,P,$,X,R,A,U],encapsulation:2})}}return s})();export{we as MessagesComponent};
